**Interactive mode debug prints:

bleshell$> cat << END
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION START ===
DEBUG-SET-TOKEN-TYPE: Position 26, analyzing token 'cat'
DEBUG-SET-TOKEN-TYPE: Current state - prev_type=ARGS, head=NULL, in_pipe=0
DEBUG-SET-TOKEN-TYPE: Keeping prev_type as ARGS (not updating yet)
DEBUG-SET-TOKEN-TYPE: Analyzing regular token for CMD vs ARGS
DEBUG-SET-TOKEN-TYPE: Conditions check:
  - !vars->head: true
  - prev_type == TYPE_PIPE: false
  - in_pipe: 0
  - is_redirection(prev_type): false
DEBUG-SET-TOKEN-TYPE: Classified as CMD (head or after pipe)
DEBUG-SET-TOKEN-TYPE: Final classification: 'cat' -> CMD
DEBUG-SET-TOKEN-TYPE: prev_type remains: ARGS (will be updated in maketoken)
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION END ===

DEBUG-TOKENIZE-LOOP: Token 13: extracting 'cat' from position 0-2
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION START ===
DEBUG-SET-TOKEN-TYPE: Position 27, analyzing token 'cat'
DEBUG-SET-TOKEN-TYPE: Current state - prev_type=ARGS, head=NULL, in_pipe=0
DEBUG-SET-TOKEN-TYPE: Keeping prev_type as ARGS (not updating yet)
DEBUG-SET-TOKEN-TYPE: Analyzing regular token for CMD vs ARGS
DEBUG-SET-TOKEN-TYPE: Conditions check:
  - !vars->head: true
  - prev_type == TYPE_PIPE: false
  - in_pipe: 0
  - is_redirection(prev_type): false
DEBUG-SET-TOKEN-TYPE: Classified as CMD (head or after pipe)
DEBUG-SET-TOKEN-TYPE: Final classification: 'cat' -> CMD
DEBUG-SET-TOKEN-TYPE: prev_type remains: ARGS (will be updated in maketoken)
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION END ===

DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 35, creating token 'cat' as CMD
DEBUG-MAKETOKEN: Before creation - prev_type=ARGS, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from ARGS to CMD
DEBUG-MAKETOKEN: prev_type now set to CMD for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 0: extracting ' ' from position 3-3
DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 36, creating token '<<' as <<
DEBUG-MAKETOKEN: Before creation - prev_type=CMD, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from CMD to <<
DEBUG-MAKETOKEN: prev_type now set to << for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 1: extracting '<<' from position 4-5
DEBUG-HEREDOC-DELIM: Storing delimiter 'END' (quoted: 0)
DEBUG-HEREDOC-DELIM: New delimiter set to 'END', expansion: ON
DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 37, creating token 'END' as ARGS
DEBUG-MAKETOKEN: Before creation - prev_type=<<, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from << to ARGS
DEBUG-MAKETOKEN: prev_type now set to ARGS for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 2: extracting 'END' from position 7-9
DEBUG-TOKEN: Adding null token safety stop
DEBUG-TOKEN: Null token added at the end of list
= TOKEN LIST =
[0] CMD [cat]
[1] << [<<]
[2] ARGS [END]
[3] ARGS []

DEBUG-LIST: = LINKED LIST =
DEBUG-LIST: [0] DEBUG-NODE[LIST@linked_list]: Type=CMD, Args=['cat'], Connections: left=(nil), right=(nil), redir=(nil), prev=(nil), next=0x573633232b10
DEBUG-LIST: [1] DEBUG-NODE[LIST@linked_list]: Type=<<, Args=['<<'], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232be0, next=0x573633232a20
DEBUG-LIST: [2] DEBUG-NODE[LIST@linked_list]: Type=ARGS, Args=['END'], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232b10, next=0x573633232950
DEBUG-LIST: [3] DEBUG-NODE[LIST@linked_list]: Type=ARGS, Args=[''], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232a20, next=(nil)
DEBUG-LIST: = END LINKED LIST (4 nodes) =
REDIR-DBG: Resetting redirection tracking state
DEBUG-FIX-REDIR: Starting to link redirections for command 'cat'
DEBUG-FIX-REDIR: Found redirection << '<<' for command 'cat'
DEBUG-FIX-REDIR: Set first redirection for command 'cat'
DEBUG-FIX-REDIR: Final redirection chain for cmd 'cat':
  0: << '<<' -> END
DEBUG-VALIDATE-REDIR: Checking redirection node type=<<
DEBUG-VALIDATE-REDIR: Valid redirection node << with embedded filename '<<'
DEBUG-MATCH-CMD: Starting command-argument matching
DEBUG-MATCH-CMD: Found command node 'cat'
DEBUG-MATCH-CMD: Checking if 'END' should be appended to 'cat'
DEBUG-IS-REDIR-TARGET: Checking node 'END', prev=<<
DEBUG-IS-REDIR-TARGET: Found redirection '<<' type=<<
DEBUG-HEREDOC-TARGET: Found heredoc, next=0x573633232a20, node=0x573633232a20
DEBUG-HEREDOC-TARGET: Current delimiter='END'
DEBUG-HEREDOC-TARGET: Node matches current delimiter!
DEBUG-IS-REDIR-TARGET: Decision for 'END': IS target
DEBUG-MATCH-CMD: Decision: SKIP
DEBUG-MATCH-CMD: Skipping 'END' (redirection target)
DEBUG-MATCH-CMD: Finished command-argument matching
=== ABSTRACT SYNTAX TREE ===
<< [<<]
├─(redir)-> CMD [cat]
├─(redir)->  [CYCLE DETECTED]
├─(left)->   CMD [cat]
  ├─(redir)->  [CYCLE DETECTED]
DEBUG-AST: = DETAILED AST =
DEBUG-AST: Node(0x573633232b10): Type=<<, Args=['<<'], Connections: { left->0x573633232be0 redir->0x573633232be0 prev->0x573633232be0 next->0x573633232a20 }
DEBUG-AST: Node(0x573633232be0): Type=CMD, Args=['cat'], Connections: { redir->0x573633232b10 next->0x573633232b10 }
DEBUG-AST: [CYCLE DETECTED] Node(0x573633232be0)
DEBUG-AST: [CYCLE DETECTED] Node(0x573633232b10)
DEBUG-EXEC-REDIR: Starting redirection execution for node type=<<
DEBUG-EXEC-REDIR: Found command node: 'cat' (pipeline_context=0)
DEBUG-EXEC-REDIR: Saved stdin=3, stdout=4
DEBUG-EXEC-REDIR: About to process redirection chain
DEBUG-FIX-CHAIN: Starting redirection chain processing
DEBUG-FIX-CHAIN: Start node: << '<<'
DEBUG-FIX-CHAIN: Command: 'cat'
DEBUG-FIX-CHAIN: Processing redirection << '<<'
DEBUG-FIX-CHAIN: Before stripping quotes: '<<'
DEBUG-FIX-CHAIN: After stripping quotes: '<<'
heredoc> This is a test interactive: $HOME
DEBUG-HEREDOC: Content (33 bytes):
This is a test interactive: $HOME
DEBUG-HEREDOC: Content (39 bytes):
This is a test interactive: /home/bleow
heredoc> END
DEBUG-FIX-CHAIN: Moving to next redirection: END
DEBUG-FIX-CHAIN: Chain processing completed successfully
DEBUG-EXEC-REDIR: Redirection successful, executing command 'cat'
This is a test interactive: /home/bleow
DEBUG-EXEC-REDIR: Command execution completed with result=0
bleshell$> cat << 'END'
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION START ===
DEBUG-SET-TOKEN-TYPE: Position 28, analyzing token 'cat'
DEBUG-SET-TOKEN-TYPE: Current state - prev_type=ARGS, head=NULL, in_pipe=0
DEBUG-SET-TOKEN-TYPE: Keeping prev_type as ARGS (not updating yet)
DEBUG-SET-TOKEN-TYPE: Analyzing regular token for CMD vs ARGS
DEBUG-SET-TOKEN-TYPE: Conditions check:
  - !vars->head: true
  - prev_type == TYPE_PIPE: false
  - in_pipe: 0
  - is_redirection(prev_type): false
DEBUG-SET-TOKEN-TYPE: Classified as CMD (head or after pipe)
DEBUG-SET-TOKEN-TYPE: Final classification: 'cat' -> CMD
DEBUG-SET-TOKEN-TYPE: prev_type remains: ARGS (will be updated in maketoken)
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION END ===

DEBUG-TOKENIZE-LOOP: Token 14: extracting 'cat' from position 0-2
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION START ===
DEBUG-SET-TOKEN-TYPE: Position 29, analyzing token 'cat'
DEBUG-SET-TOKEN-TYPE: Current state - prev_type=ARGS, head=NULL, in_pipe=0
DEBUG-SET-TOKEN-TYPE: Keeping prev_type as ARGS (not updating yet)
DEBUG-SET-TOKEN-TYPE: Analyzing regular token for CMD vs ARGS
DEBUG-SET-TOKEN-TYPE: Conditions check:
  - !vars->head: true
  - prev_type == TYPE_PIPE: false
  - in_pipe: 0
  - is_redirection(prev_type): false
DEBUG-SET-TOKEN-TYPE: Classified as CMD (head or after pipe)
DEBUG-SET-TOKEN-TYPE: Final classification: 'cat' -> CMD
DEBUG-SET-TOKEN-TYPE: prev_type remains: ARGS (will be updated in maketoken)
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION END ===

DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 38, creating token 'cat' as CMD
DEBUG-MAKETOKEN: Before creation - prev_type=ARGS, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from ARGS to CMD
DEBUG-MAKETOKEN: prev_type now set to CMD for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 0: extracting ' ' from position 3-3
DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 39, creating token '<<' as <<
DEBUG-MAKETOKEN: Before creation - prev_type=CMD, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from CMD to <<
DEBUG-MAKETOKEN: prev_type now set to << for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 1: extracting '<<' from position 4-5
DEBUG-HEREDOC-DELIM: Storing delimiter 'END' (quoted: 1)
DEBUG-HEREDOC-DELIM: New delimiter set to 'END', expansion: OFF
DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 40, creating token ''END'' as ARGS
DEBUG-MAKETOKEN: Before creation - prev_type=<<, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from << to ARGS
DEBUG-MAKETOKEN: prev_type now set to ARGS for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 2: extracting ''END'' from position 7-11
DEBUG-TOKEN: Adding null token safety stop
DEBUG-TOKEN: Null token added at the end of list
= TOKEN LIST =
[0] CMD [cat]
[1] << [<<]
[2] ARGS ['END']
[3] ARGS []

DEBUG-LIST: = LINKED LIST =
DEBUG-LIST: [0] DEBUG-NODE[LIST@linked_list]: Type=CMD, Args=['cat'], Connections: left=(nil), right=(nil), redir=(nil), prev=(nil), next=0x573633232a20
DEBUG-LIST: [1] DEBUG-NODE[LIST@linked_list]: Type=<<, Args=['<<'], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232950, next=0x573633232b10
DEBUG-LIST: [2] DEBUG-NODE[LIST@linked_list]: Type=ARGS, Args=[''END''], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232a20, next=0x573633232be0
DEBUG-LIST: [3] DEBUG-NODE[LIST@linked_list]: Type=ARGS, Args=[''], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232b10, next=(nil)
DEBUG-LIST: = END LINKED LIST (4 nodes) =
REDIR-DBG: Resetting redirection tracking state
DEBUG-FIX-REDIR: Starting to link redirections for command 'cat'
DEBUG-FIX-REDIR: Found redirection << '<<' for command 'cat'
DEBUG-FIX-REDIR: Set first redirection for command 'cat'
DEBUG-FIX-REDIR: Final redirection chain for cmd 'cat':
  0: << '<<' -> END
DEBUG-VALIDATE-REDIR: Checking redirection node type=<<
DEBUG-VALIDATE-REDIR: Valid redirection node << with embedded filename '<<'
DEBUG-MATCH-CMD: Starting command-argument matching
DEBUG-MATCH-CMD: Found command node 'cat'
DEBUG-MATCH-CMD: Checking if ''END'' should be appended to 'cat'
DEBUG-IS-REDIR-TARGET: Checking node ''END'', prev=<<
DEBUG-IS-REDIR-TARGET: Found redirection '<<' type=<<
DEBUG-HEREDOC-TARGET: Found heredoc, next=0x573633232b10, node=0x573633232b10
DEBUG-HEREDOC-TARGET: Current delimiter='END'
DEBUG-IS-REDIR-TARGET: Node directly follows redirection
DEBUG-IS-REDIR-TARGET: Redirection has embedded arg: '<<'
DEBUG-IS-REDIR-TARGET: Decision for ''END'': NOT target
DEBUG-MATCH-CMD: Decision: APPEND
DEBUG-ARGS: Before append - [cat ]
DEBUG-ARGS: Appending: ''END''
DEBUG-ARGS: Before append - [cat ]
DEBUG-ARGS: Appending: ''END''
DEBUG-MATCH-CMD: Finished command-argument matching
=== ABSTRACT SYNTAX TREE ===
<< [<<]
├─(redir)-> CMD [cat 'END']
├─(redir)->  [CYCLE DETECTED]
├─(left)->   CMD [cat 'END']
  ├─(redir)->  [CYCLE DETECTED]
DEBUG-AST: = DETAILED AST =
DEBUG-AST: Node(0x573633232a20): Type=<<, Args=['<<'], Connections: { left->0x573633232950 redir->0x573633232950 prev->0x573633232950 next->0x573633232b10 }
DEBUG-AST: Node(0x573633232950): Type=CMD, Args=['cat', ''END''], Connections: { redir->0x573633232a20 next->0x573633232a20 }
DEBUG-AST: [CYCLE DETECTED] Node(0x573633232950)
DEBUG-AST: [CYCLE DETECTED] Node(0x573633232a20)
DEBUG-EXEC-REDIR: Starting redirection execution for node type=<<
DEBUG-EXEC-REDIR: Found command node: 'cat' (pipeline_context=0)
DEBUG-EXEC-REDIR: Saved stdin=3, stdout=4
DEBUG-EXEC-REDIR: About to process redirection chain
DEBUG-FIX-CHAIN: Starting redirection chain processing
DEBUG-FIX-CHAIN: Start node: << '<<'
DEBUG-FIX-CHAIN: Command: 'cat'
DEBUG-FIX-CHAIN: Processing redirection << '<<'
DEBUG-FIX-CHAIN: Before stripping quotes: '<<'
DEBUG-FIX-CHAIN: After stripping quotes: '<<'
heredoc> This is a test interactive: $HOME
DEBUG-HEREDOC: Content (33 bytes):
This is a test interactive: $HOME
DEBUG-HEREDOC: Content (33 bytes):
This is a test interactive: $HOME
heredoc> END
DEBUG-FIX-CHAIN: Moving to next redirection: END
DEBUG-FIX-CHAIN: Chain processing completed successfully
DEBUG-EXEC-REDIR: Redirection successful, executing command 'cat'
cat: "'END'": No such file or directory
DEBUG-EXEC-REDIR: Command execution completed with result=1
bleshell$> cat << "END"
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION START ===
DEBUG-SET-TOKEN-TYPE: Position 30, analyzing token 'cat'
DEBUG-SET-TOKEN-TYPE: Current state - prev_type=ARGS, head=NULL, in_pipe=0
DEBUG-SET-TOKEN-TYPE: Keeping prev_type as ARGS (not updating yet)
DEBUG-SET-TOKEN-TYPE: Analyzing regular token for CMD vs ARGS
DEBUG-SET-TOKEN-TYPE: Conditions check:
  - !vars->head: true
  - prev_type == TYPE_PIPE: false
  - in_pipe: 0
  - is_redirection(prev_type): false
DEBUG-SET-TOKEN-TYPE: Classified as CMD (head or after pipe)
DEBUG-SET-TOKEN-TYPE: Final classification: 'cat' -> CMD
DEBUG-SET-TOKEN-TYPE: prev_type remains: ARGS (will be updated in maketoken)
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION END ===

DEBUG-TOKENIZE-LOOP: Token 15: extracting 'cat' from position 0-2
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION START ===
DEBUG-SET-TOKEN-TYPE: Position 31, analyzing token 'cat'
DEBUG-SET-TOKEN-TYPE: Current state - prev_type=ARGS, head=NULL, in_pipe=0
DEBUG-SET-TOKEN-TYPE: Keeping prev_type as ARGS (not updating yet)
DEBUG-SET-TOKEN-TYPE: Analyzing regular token for CMD vs ARGS
DEBUG-SET-TOKEN-TYPE: Conditions check:
  - !vars->head: true
  - prev_type == TYPE_PIPE: false
  - in_pipe: 0
  - is_redirection(prev_type): false
DEBUG-SET-TOKEN-TYPE: Classified as CMD (head or after pipe)
DEBUG-SET-TOKEN-TYPE: Final classification: 'cat' -> CMD
DEBUG-SET-TOKEN-TYPE: prev_type remains: ARGS (will be updated in maketoken)
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION END ===

DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 41, creating token 'cat' as CMD
DEBUG-MAKETOKEN: Before creation - prev_type=ARGS, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from ARGS to CMD
DEBUG-MAKETOKEN: prev_type now set to CMD for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 0: extracting ' ' from position 3-3
DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 42, creating token '<<' as <<
DEBUG-MAKETOKEN: Before creation - prev_type=CMD, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from CMD to <<
DEBUG-MAKETOKEN: prev_type now set to << for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 1: extracting '<<' from position 4-5
DEBUG-HEREDOC-DELIM: Storing delimiter 'END' (quoted: 1)
DEBUG-HEREDOC-DELIM: New delimiter set to 'END', expansion: OFF
DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 43, creating token '"END"' as ARGS
DEBUG-MAKETOKEN: Before creation - prev_type=<<, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from << to ARGS
DEBUG-MAKETOKEN: prev_type now set to ARGS for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 2: extracting '"END"' from position 7-11
DEBUG-TOKEN: Adding null token safety stop
DEBUG-TOKEN: Null token added at the end of list
= TOKEN LIST =
[0] CMD [cat]
[1] << [<<]
[2] ARGS ["END"]
[3] ARGS []

DEBUG-LIST: = LINKED LIST =
DEBUG-LIST: [0] DEBUG-NODE[LIST@linked_list]: Type=CMD, Args=['cat'], Connections: left=(nil), right=(nil), redir=(nil), prev=(nil), next=0x573633232b10
DEBUG-LIST: [1] DEBUG-NODE[LIST@linked_list]: Type=<<, Args=['<<'], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232be0, next=0x573633232a20
DEBUG-LIST: [2] DEBUG-NODE[LIST@linked_list]: Type=ARGS, Args=['"END"'], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232b10, next=0x573633232950
DEBUG-LIST: [3] DEBUG-NODE[LIST@linked_list]: Type=ARGS, Args=[''], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232a20, next=(nil)
DEBUG-LIST: = END LINKED LIST (4 nodes) =
REDIR-DBG: Resetting redirection tracking state
DEBUG-FIX-REDIR: Starting to link redirections for command 'cat'
DEBUG-FIX-REDIR: Found redirection << '<<' for command 'cat'
DEBUG-FIX-REDIR: Set first redirection for command 'cat'
DEBUG-FIX-REDIR: Final redirection chain for cmd 'cat':
  0: << '<<' -> END
DEBUG-VALIDATE-REDIR: Checking redirection node type=<<
DEBUG-VALIDATE-REDIR: Valid redirection node << with embedded filename '<<'
DEBUG-MATCH-CMD: Starting command-argument matching
DEBUG-MATCH-CMD: Found command node 'cat'
DEBUG-MATCH-CMD: Checking if '"END"' should be appended to 'cat'
DEBUG-IS-REDIR-TARGET: Checking node '"END"', prev=<<
DEBUG-IS-REDIR-TARGET: Found redirection '<<' type=<<
DEBUG-HEREDOC-TARGET: Found heredoc, next=0x573633232a20, node=0x573633232a20
DEBUG-HEREDOC-TARGET: Current delimiter='END'
DEBUG-IS-REDIR-TARGET: Node directly follows redirection
DEBUG-IS-REDIR-TARGET: Redirection has embedded arg: '<<'
DEBUG-IS-REDIR-TARGET: Decision for '"END"': NOT target
DEBUG-MATCH-CMD: Decision: APPEND
DEBUG-ARGS: Before append - [cat ]
DEBUG-ARGS: Appending: '"END"'
DEBUG-ARGS: Before append - [cat ]
DEBUG-ARGS: Appending: '"END"'
DEBUG-MATCH-CMD: Finished command-argument matching
=== ABSTRACT SYNTAX TREE ===
<< [<<]
├─(redir)-> CMD [cat "END"]
├─(redir)->  [CYCLE DETECTED]
├─(left)->   CMD [cat "END"]
  ├─(redir)->  [CYCLE DETECTED]
DEBUG-AST: = DETAILED AST =
DEBUG-AST: Node(0x573633232b10): Type=<<, Args=['<<'], Connections: { left->0x573633232be0 redir->0x573633232be0 prev->0x573633232be0 next->0x573633232a20 }
DEBUG-AST: Node(0x573633232be0): Type=CMD, Args=['cat', '"END"'], Connections: { redir->0x573633232b10 next->0x573633232b10 }
DEBUG-AST: [CYCLE DETECTED] Node(0x573633232be0)
DEBUG-AST: [CYCLE DETECTED] Node(0x573633232b10)
DEBUG-EXEC-REDIR: Starting redirection execution for node type=<<
DEBUG-EXEC-REDIR: Found command node: 'cat' (pipeline_context=0)
DEBUG-EXEC-REDIR: Saved stdin=3, stdout=4
DEBUG-EXEC-REDIR: About to process redirection chain
DEBUG-FIX-CHAIN: Starting redirection chain processing
DEBUG-FIX-CHAIN: Start node: << '<<'
DEBUG-FIX-CHAIN: Command: 'cat'
DEBUG-FIX-CHAIN: Processing redirection << '<<'
DEBUG-FIX-CHAIN: Before stripping quotes: '<<'
DEBUG-FIX-CHAIN: After stripping quotes: '<<'
heredoc> This is a test: $HOME
DEBUG-HEREDOC: Content (21 bytes):
This is a test: $HOME
DEBUG-HEREDOC: Content (21 bytes):
This is a test: $HOME
heredoc> END
DEBUG-FIX-CHAIN: Moving to next redirection: END
DEBUG-FIX-CHAIN: Chain processing completed successfully
DEBUG-EXEC-REDIR: Redirection successful, executing command 'cat'
cat: '"END"': No such file or directory
DEBUG-EXEC-REDIR: Command execution completed with result=1
bleshell$> cat << '"END"'
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION START ===
DEBUG-SET-TOKEN-TYPE: Position 32, analyzing token 'cat'
DEBUG-SET-TOKEN-TYPE: Current state - prev_type=ARGS, head=NULL, in_pipe=0
DEBUG-SET-TOKEN-TYPE: Keeping prev_type as ARGS (not updating yet)
DEBUG-SET-TOKEN-TYPE: Analyzing regular token for CMD vs ARGS
DEBUG-SET-TOKEN-TYPE: Conditions check:
  - !vars->head: true
  - prev_type == TYPE_PIPE: false
  - in_pipe: 0
  - is_redirection(prev_type): false
DEBUG-SET-TOKEN-TYPE: Classified as CMD (head or after pipe)
DEBUG-SET-TOKEN-TYPE: Final classification: 'cat' -> CMD
DEBUG-SET-TOKEN-TYPE: prev_type remains: ARGS (will be updated in maketoken)
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION END ===

DEBUG-TOKENIZE-LOOP: Token 16: extracting 'cat' from position 0-2
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION START ===
DEBUG-SET-TOKEN-TYPE: Position 33, analyzing token 'cat'
DEBUG-SET-TOKEN-TYPE: Current state - prev_type=ARGS, head=NULL, in_pipe=0
DEBUG-SET-TOKEN-TYPE: Keeping prev_type as ARGS (not updating yet)
DEBUG-SET-TOKEN-TYPE: Analyzing regular token for CMD vs ARGS
DEBUG-SET-TOKEN-TYPE: Conditions check:
  - !vars->head: true
  - prev_type == TYPE_PIPE: false
  - in_pipe: 0
  - is_redirection(prev_type): false
DEBUG-SET-TOKEN-TYPE: Classified as CMD (head or after pipe)
DEBUG-SET-TOKEN-TYPE: Final classification: 'cat' -> CMD
DEBUG-SET-TOKEN-TYPE: prev_type remains: ARGS (will be updated in maketoken)
DEBUG-SET-TOKEN-TYPE: === TOKEN CLASSIFICATION END ===

DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 44, creating token 'cat' as CMD
DEBUG-MAKETOKEN: Before creation - prev_type=ARGS, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from ARGS to CMD
DEBUG-MAKETOKEN: prev_type now set to CMD for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 0: extracting ' ' from position 3-3
DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 45, creating token '<<' as <<
DEBUG-MAKETOKEN: Before creation - prev_type=CMD, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from CMD to <<
DEBUG-MAKETOKEN: prev_type now set to << for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 1: extracting '<<' from position 4-5
DEBUG-HEREDOC-DELIM: Storing delimiter '"END"' (quoted: 1)
DEBUG-HEREDOC-DELIM: New delimiter set to '"END"', expansion: OFF
DEBUG-MAKETOKEN: === TOKEN CREATION START ===
DEBUG-MAKETOKEN: Position 46, creating token ''"END"'' as ARGS
DEBUG-MAKETOKEN: Before creation - prev_type=<<, curr_type=CMD
DEBUG-MAKETOKEN: Pipeline state - in_pipe=0
DEBUG-MAKETOKEN: Updating prev_type from << to ARGS
DEBUG-MAKETOKEN: prev_type now set to ARGS for next classification
DEBUG-MAKETOKEN: === TOKEN CREATION END ===

DEBUG-TOKENIZE-LOOP: Token 2: extracting ''"END"'' from position 7-13
DEBUG-TOKEN: Adding null token safety stop
DEBUG-TOKEN: Null token added at the end of list
= TOKEN LIST =
[0] CMD [cat]
[1] << [<<]
[2] ARGS ['"END"']
[3] ARGS []

DEBUG-LIST: = LINKED LIST =
DEBUG-LIST: [0] DEBUG-NODE[LIST@linked_list]: Type=CMD, Args=['cat'], Connections: left=(nil), right=(nil), redir=(nil), prev=(nil), next=0x573633232a20
DEBUG-LIST: [1] DEBUG-NODE[LIST@linked_list]: Type=<<, Args=['<<'], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232950, next=0x573633232b10
DEBUG-LIST: [2] DEBUG-NODE[LIST@linked_list]: Type=ARGS, Args=[''"END"''], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232a20, next=0x573633232be0
DEBUG-LIST: [3] DEBUG-NODE[LIST@linked_list]: Type=ARGS, Args=[''], Connections: left=(nil), right=(nil), redir=(nil), prev=0x573633232b10, next=(nil)
DEBUG-LIST: = END LINKED LIST (4 nodes) =
REDIR-DBG: Resetting redirection tracking state
DEBUG-FIX-REDIR: Starting to link redirections for command 'cat'
DEBUG-FIX-REDIR: Found redirection << '<<' for command 'cat'
DEBUG-FIX-REDIR: Set first redirection for command 'cat'
DEBUG-FIX-REDIR: Final redirection chain for cmd 'cat':
  0: << '<<' -> END
DEBUG-VALIDATE-REDIR: Checking redirection node type=<<
DEBUG-VALIDATE-REDIR: Valid redirection node << with embedded filename '<<'
DEBUG-MATCH-CMD: Starting command-argument matching
DEBUG-MATCH-CMD: Found command node 'cat'
DEBUG-MATCH-CMD: Checking if ''"END"'' should be appended to 'cat'
DEBUG-IS-REDIR-TARGET: Checking node ''"END"'', prev=<<
DEBUG-IS-REDIR-TARGET: Found redirection '<<' type=<<
DEBUG-HEREDOC-TARGET: Found heredoc, next=0x573633232b10, node=0x573633232b10
DEBUG-HEREDOC-TARGET: Current delimiter='"END"'
DEBUG-IS-REDIR-TARGET: Node directly follows redirection
DEBUG-IS-REDIR-TARGET: Redirection has embedded arg: '<<'
DEBUG-IS-REDIR-TARGET: Decision for ''"END"'': NOT target
DEBUG-MATCH-CMD: Decision: APPEND
DEBUG-ARGS: Before append - [cat ]
DEBUG-ARGS: Appending: ''"END"''
DEBUG-ARGS: Before append - [cat ]
DEBUG-ARGS: Appending: ''"END"''
DEBUG-MATCH-CMD: Finished command-argument matching
=== ABSTRACT SYNTAX TREE ===
<< [<<]
├─(redir)-> CMD [cat '"END"']
├─(redir)->  [CYCLE DETECTED]
├─(left)->   CMD [cat '"END"']
  ├─(redir)->  [CYCLE DETECTED]
DEBUG-AST: = DETAILED AST =
DEBUG-AST: Node(0x573633232a20): Type=<<, Args=['<<'], Connections: { left->0x573633232950 redir->0x573633232950 prev->0x573633232950 next->0x573633232b10 }
DEBUG-AST: Node(0x573633232950): Type=CMD, Args=['cat', ''"END"''], Connections: { redir->0x573633232a20 next->0x573633232a20 }
DEBUG-AST: [CYCLE DETECTED] Node(0x573633232950)
DEBUG-AST: [CYCLE DETECTED] Node(0x573633232a20)
DEBUG-EXEC-REDIR: Starting redirection execution for node type=<<
DEBUG-EXEC-REDIR: Found command node: 'cat' (pipeline_context=0)
DEBUG-EXEC-REDIR: Saved stdin=3, stdout=4
DEBUG-EXEC-REDIR: About to process redirection chain
DEBUG-FIX-CHAIN: Starting redirection chain processing
DEBUG-FIX-CHAIN: Start node: << '<<'
DEBUG-FIX-CHAIN: Command: 'cat'
DEBUG-FIX-CHAIN: Processing redirection << '<<'
DEBUG-FIX-CHAIN: Before stripping quotes: '<<'
DEBUG-FIX-CHAIN: After stripping quotes: '<<'
heredoc> This is a test interactive: $HOME
DEBUG-HEREDOC: Content (33 bytes):
This is a test interactive: $HOME
DEBUG-HEREDOC: Content (33 bytes):
This is a test interactive: $HOME
heredoc> END
DEBUG-HEREDOC: Content (3 bytes):
END
DEBUG-HEREDOC: Content (3 bytes):
END
heredoc> 'END'
DEBUG-HEREDOC: Content (5 bytes):
'END'
DEBUG-HEREDOC: Content (5 bytes):
'END'
heredoc> "'END'"
DEBUG-HEREDOC: Content (7 bytes):
"'END'"
DEBUG-HEREDOC: Content (7 bytes):
"'END'"
heredoc> "END"
DEBUG-FIX-CHAIN: Moving to next redirection: END
DEBUG-FIX-CHAIN: Chain processing completed successfully
DEBUG-EXEC-REDIR: Redirection successful, executing command 'cat'
cat: ''\''"END"'\''': No such file or directory
DEBUG-EXEC-REDIR: Command execution completed with result=1
bleshell$> 

**Multi-line mode debug prints**